{"version":3,"sources":["../src/repository.js"],"names":["define","Ajax","setDiscussionSubscriptionState","peerforumId","discussionId","targetState","call","methodname","args","peerforumid","discussionid","targetstate","addDiscussionPost","postid","subject","message","messageformat","isprivatereply","topreferredformat","options","name","value","setDiscussionLockState","setFavouriteDiscussionState","setPinDiscussionState","getDiscussionByUserID","userid","cmid","sortby","sortdirection","getDiscussionPosts"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * PeerForum repository class to encapsulate all of the AJAX requests that subscribe or unsubscribe\n * can be sent for peerforum.\n *\n * @module     mod_peerforum/repository\n * @package    mod_peerforum\n * @copyright  2019 Andrew Nicols <andrew@nicols.co.uk>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['core/ajax'], function(Ajax) {\n    /**\n     * Set the subscription state for a discussion in a peerforum.\n     *\n     * @param {number} peerforumId ID of the peerforum the discussion belongs to\n     * @param {number} discussionId ID of the discussion with the subscription state\n     * @param {boolean} targetState Set the subscribed state. True == subscribed; false == unsubscribed.\n     * @return {object} jQuery promise\n     */\n    var setDiscussionSubscriptionState = function(peerforumId, discussionId, targetState) {\n        var request = {\n            methodname: 'mod_peerforum_set_subscription_state',\n            args: {\n                peerforumid: peerforumId,\n                discussionid: discussionId,\n                targetstate: targetState\n            }\n        };\n        return Ajax.call([request])[0];\n    };\n\n    var addDiscussionPost = function(postid, subject, message, messageformat, isprivatereply, topreferredformat) {\n        var request = {\n            methodname: 'mod_peerforum_add_discussion_post',\n            args: {\n                postid: postid,\n                message: message,\n                messageformat: messageformat,\n                subject: subject,\n                options: [{\n                    name: \"private\",\n                    value: isprivatereply,\n                }, {\n                    name: \"topreferredformat\",\n                    value: topreferredformat,\n                }]\n            }\n        };\n        return Ajax.call([request])[0];\n    };\n\n    /**\n     * Set the favourite state for a discussion in a peerforum.\n     *\n     * @param {number} peerforumId ID of the peerforum the discussion belongs to\n     * @param {number} discussionId ID of the discussion with the subscription state\n     * @param {null|date} targetState Set the favourite state. True == favourited; false == unfavourited.\n     * @return {object} jQuery promise\n     */\n    var setFavouriteDiscussionState = function(peerforumId, discussionId, targetState) {\n        var request = {\n            methodname: 'mod_peerforum_toggle_favourite_state',\n            args: {\n                discussionid: discussionId,\n                targetstate: targetState\n            }\n        };\n        return Ajax.call([request])[0];\n    };\n\n    var setDiscussionLockState = function(peerforumId, discussionId, targetState) {\n        var request = {\n            methodname: 'mod_peerforum_set_lock_state',\n            args: {\n                peerforumid: peerforumId,\n                discussionid: discussionId,\n                targetstate: targetState\n            }\n        };\n        return Ajax.call([request])[0];\n    };\n\n    /**\n     * Set the pinned state for the discussion provided.\n     *\n     * @param {number} peerforumid\n     * @param {number} discussionid\n     * @param {boolean} targetstate\n     * @return {*|Promise}\n     */\n    var setPinDiscussionState = function(peerforumid, discussionid, targetstate) {\n        var request = {\n            methodname: 'mod_peerforum_set_pin_state',\n            args: {\n                discussionid: discussionid,\n                targetstate: targetstate\n            }\n        };\n        return Ajax.call([request])[0];\n    };\n\n    /**\n     * Get the discussions for the user and cmid provided.\n     *\n     * @param {number} userid\n     * @param {number} cmid\n     * @param {string} sortby\n     * @param {string} sortdirection\n     * @return {*|Promise}\n     */\n    var getDiscussionByUserID = function(userid, cmid, sortby = 'modified', sortdirection = 'DESC') {\n        var request = {\n            methodname: 'mod_peerforum_get_discussion_posts_by_userid',\n            args: {\n                userid: userid,\n                cmid: cmid,\n                sortby: sortby,\n                sortdirection: sortdirection,\n            },\n        };\n        return Ajax.call([request])[0];\n    };\n\n    /**\n     * Get the posts for the discussion ID provided.\n     *\n     * @param {number} discussionId\n     * @param {String} sortby\n     * @param {String} sortdirection\n     * @return {*|Promise}\n     */\n    var getDiscussionPosts = function(discussionId, sortby = 'created', sortdirection = 'ASC') {\n        var request = {\n            methodname: 'mod_peerforum_get_discussion_posts',\n            args: {\n                discussionid: discussionId,\n                sortby: sortby,\n                sortdirection: sortdirection,\n            },\n        };\n        return Ajax.call([request])[0];\n    };\n\n    return {\n        setDiscussionSubscriptionState: setDiscussionSubscriptionState,\n        addDiscussionPost: addDiscussionPost,\n        setDiscussionLockState: setDiscussionLockState,\n        setFavouriteDiscussionState: setFavouriteDiscussionState,\n        setPinDiscussionState: setPinDiscussionState,\n        getDiscussionByUserID: getDiscussionByUserID,\n        getDiscussionPosts: getDiscussionPosts,\n    };\n});\n"],"file":"repository.min.js"}